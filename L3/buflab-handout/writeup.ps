%!PS-Adobe-2.0
%%Creator: dvips(k) 5.95a Copyright 2005 Radical Eye Software
%%Title: writeup.dvi
%%Pages: 11
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Times-Italic Courier
%%+ Courier-Oblique CMSY10 CMMI10 CMR10
%%DocumentPaperSizes: Letter
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -o writeup.ps writeup.dvi
%DVIPSParameters: dpi=600
%DVIPSSource:  TeX output 2010.02.12:0125
%%BeginProcSet: tex.pro 0 0
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/CharBuilder{save 3 1 roll S A/base get 2 index get S
/BitMaps get S get/Cd X pop/ctr 0 N Cdx 0 Cx Cy Ch sub Cx Cw add Cy
setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx sub Cy .1 sub]{Ci}imagemask
restore}B/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc 0 0
% File 8r.enc  TeX Base 1 Encoding  Revision 2.0  2002-10-30
%
% @@psencodingfile@{
%   author    = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry,
%                W. Schmidt, P. Lehman",
%   version   = "2.0",
%   date      = "30 October 2002",
%   filename  = "8r.enc",
%   email     = "tex-fonts@@tug.org",
%   docstring = "This is the encoding vector for Type1 and TrueType
%                fonts to be used with TeX.  This file is part of the
%                PSNFSS bundle, version 9"
% @}
% 
% The idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard encoding, ISO Latin 1, Windows ANSI including the euro symbol,
% MacRoman, and some extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% These are /dotlessj /ff /ffi /ffl.
% 
% (4) hyphen appears twice for compatibility with both ASCII and Windows.
%
% (5) /Euro was assigned to 128, as in Windows ANSI
%
% (6) Missing characters from MacRoman encoding incorporated as follows:
%
%     PostScript      MacRoman        TeXBase1
%     --------------  --------------  --------------
%     /notequal       173             0x16
%     /infinity       176             0x17
%     /lessequal      178             0x18
%     /greaterequal   179             0x19
%     /partialdiff    182             0x1A
%     /summation      183             0x1B
%     /product        184             0x1C
%     /pi             185             0x1D
%     /integral       186             0x81
%     /Omega          189             0x8D
%     /radical        195             0x8E
%     /approxequal    197             0x8F
%     /Delta          198             0x9D
%     /lozenge        215             0x9E
%
/TeXBase1Encoding [
% 0x00
 /.notdef /dotaccent /fi /fl
 /fraction /hungarumlaut /Lslash /lslash
 /ogonek /ring /.notdef /breve
 /minus /.notdef /Zcaron /zcaron
% 0x10
 /caron /dotlessi /dotlessj /ff
 /ffi /ffl /notequal /infinity
 /lessequal /greaterequal /partialdiff /summation
 /product /pi /grave /quotesingle
% 0x20
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus
 /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three
 /four /five /six /seven
 /eight /nine /colon /semicolon
 /less /equal /greater /question
% 0x40
 /at /A /B /C
 /D /E /F /G
 /H /I /J /K
 /L /M /N /O
% 0x50
 /P /Q /R /S
 /T /U /V /W
 /X /Y /Z /bracketleft
 /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c
 /d /e /f /g
 /h /i /j /k
 /l /m /n /o
% 0x70
 /p /q /r /s
 /t /u /v /w
 /x /y /z /braceleft
 /bar /braceright /asciitilde /.notdef
% 0x80
 /Euro /integral /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /Omega /radical /approxequal
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /Delta /lozenge /Ydieresis
% 0xA0
 /.notdef /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot /hyphen /registered /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde
 /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def


%%EndProcSet
%%BeginProcSet: texps.pro 0 0
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]FontType 0
ne{/Metrics exch def dict begin Encoding{exch dup type/integertype ne{
pop pop 1 sub dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get
div def}ifelse}forall Metrics/Metrics currentdict end def}{{1 index type
/nametype eq{exit}if exch pop}loop}ifelse[2 index currentdict end
definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{dup
sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1 roll
mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def dup[
exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}if}
forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}def
end

%%EndProcSet
%%BeginFont: CMR10
%!PS-AdobeFont-1.1: CMR10 1.00B
%%CreationDate: 1992 Feb 19 19:54:52
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.00B) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMR10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle 0 def
/isFixedPitch false def
end readonly def
/FontName /CMR10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 49 /one put
dup 50 /two put
dup 55 /seven put
readonly def
/FontBBox{-251 -250 1009 969}readonly def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA052A014267B7904EB3C0D3BD0B83D891
016CA6CA4B712ADEB258FAAB9A130EE605E61F77FC1B738ABC7C51CD46EF8171
9098D5FEE67660E69A7AB91B58F29A4D79E57022F783EB0FBBB6D4F4EC35014F
D2DECBA99459A4C59DF0C6EBA150284454E707DC2100C15B76B4C19B84363758
469A6C558785B226332152109871A9883487DD7710949204DDCF837E6A8708B8
2BDBF16FBC7512FAA308A093FE5CF7158F1163BC1F3352E22A1452E73FECA8A4
87100FB1FFC4C8AF409B2067537220E605DA0852CA49839E1386AF9D7A1A455F
D1F017CE45884D76EF2CB9BC5821FD25365DDEA6E45F332B5F68A44AD8A530F0
92A36FAC8D27F9087AFEEA2096F839A2BC4B937F24E080EF7C0F9374A18D565C
295A05210DB96A23175AC59A9BD0147A310EF49C551A417E0A22703F94FF7B75
409A5D417DA6730A69E310FA6A4229FC7E4F620B0FC4C63C50E99E179EB51E4C
4BC45217722F1E8E40F1E1428E792EAFE05C5A50D38C52114DFCD24D54027CBF
2512DD116F0463DE4052A7AD53B641A27E81E481947884CE35661B49153FA19E
0A2A860C7B61558671303DE6AE06A80E4E450E17067676E6BBB42A9A24ACBC3E
B0CA7B7A3BFEA84FED39CCFB6D545BB2BCC49E5E16976407AB9D94556CD4F008
24EF579B6800B6DC3AAF840B3FC6822872368E3B4274DD06CA36AF8F6346C11B
43C772CC242F3B212C4BD7018D71A1A74C9A94ED0093A5FB6557F4E0751047AF
D72098ECA301B8AE68110F983796E581F106144951DF5B750432A230FDA3B575
5A38B5E7972AABC12306A01A99FCF8189D71B8DBF49550BAEA9CF1B97CBFC7CC
96498ECC938B1A1710B670657DE923A659DB8757147B140A48067328E7E3F9C3
7D1888B284904301450CE0BC15EEEA00E48CCD6388F3FC3C8578EF9A20A0E06E
4F7ADDAF0E7D1E182D115BF1AD931977325AD391E72E2B13CC108E3726C11099
E2000623188AAAC9F3E233EB253BDD8B0A4759A66A113E066238B0086AC1B634
5ABFF90E4B5ED3FA69C22541981B2BFC9710AEF6B50A8BB53431C7B4D380D721
639E005D6B4688EE16BFF48443E7C9E5FB5BC5883E271CB03428955D5B6A6C01
F9D9F44C93F0C94D9D0728D2A6F5390B793E4205F4BBFADB26785DCF0EAE8467
0F2CB7F2ECC80860473B0AF607E131ADC315664B74C8FBBB3169708EC9EF9977
FB3172531CB7AFD5E6CE40A819129D46BA23A46C548A8713BE1A4125FE8E4E94
FD2FB0777C4853D15397A4FF99571D812F2B9E35004919C4314D9F6E54371AA0
38C011069DFBC2C687DB92D7B7010B8E4A2F593D6B5848C027F20628B9A67DD4
3B35CFD3570714A4771F582487CF985C9D9DBCE6CF2B1543E877D3494741211E
044EAF9744DE6C3D87B44584FA866B45484E33246047A120441A969B28C02114
DFA45627F09A98791A218F5269138F8D0E8CFCC710E11B529BA50C401A88F645
4D14D6B32257528C6DA7D61DEB30A60F5E1CE52FC257C8EC202848D643AAC01A
245AD418622ABA265CC48FE2E6448276CD369CE1C756C7B3713FB42D7E45E89D
16E4DB6A91EE2FCF9A89A4A0528B7927D758EAFE7E732BAD18EDC01C71CAAF37
07F2E75B7B21E77D0B9835C20B93887BF92AA22B926B0763139CD3F5BA7AB1DC
8E339878067BA376AEB10160675212D29C23098382C94E8D2640338087282799
8DBA30A2CBD20CC0AAE27227F0CE58A4625F9ABFA03EDE440D7A8B2C7E4DD894
74A0A5B867450E9D8AC6326172A1F734EC20E53794E8210A4D27626908518DAA
4F419760A9B8ADA612B3EF9F58431C1AE331E08832E3B7B903FBAB9985711C92
EA9928B5EAC7511F9B960A53
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
%%BeginFont: CMMI10
%!PS-AdobeFont-1.1: CMMI10 1.100
%%CreationDate: 1996 Jul 23 07:53:57
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMI10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMI10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 120 /x put
readonly def
/FontBBox{-32 -250 1048 750}readonly def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA0529731C99A784CCBE85B4993B2EEBDE
3B12D472B7CF54651EF21185116A69AB1096ED4BAD2F646635E019B6417CC77B
532F85D811C70D1429A19A5307EF63EB5C5E02C89FC6C20F6D9D89E7D91FE470
B72BEFDA23F5DF76BE05AF4CE93137A219ED8A04A9D7D6FDF37E6B7FCDE0D90B
986423E5960A5D9FBB4C956556E8DF90CBFAEC476FA36FD9A5C8175C9AF513FE
D919C2DDD26BDC0D99398B9F4D03D5993DFC0930297866E1CD0A319B6B1FD958
9E394A533A081C36D456A09920001A3D2199583EB9B84B4DEE08E3D12939E321
990CD249827D9648574955F61BAAA11263A91B6C3D47A5190165B0C25ABF6D3E
6EC187E4B05182126BB0D0323D943170B795255260F9FD25F2248D04F45DFBFB
DEF7FF8B19BFEF637B210018AE02572B389B3F76282BEB29CC301905D388C721
59616893E774413F48DE0B408BC66DCE3FE17CB9F84D205839D58014D6A88823
D9320AE93AF96D97A02C4D5A2BB2B8C7925C4578003959C46E3CE1A2F0EAC4BF
8B9B325E46435BDE60BC54D72BC8ACB5C0A34413AC87045DC7B84646A324B808
6FD8E34217213E131C3B1510415CE45420688ED9C1D27890EC68BD7C1235FAF9
1DAB3A369DD2FC3BE5CF9655C7B7EDA7361D7E05E5831B6B8E2EEC542A7B38EE
03BE4BAC6079D038ACB3C7C916279764547C2D51976BABA94BA9866D79F13909
95AA39B0F03103A07CBDF441B8C5669F729020AF284B7FF52A29C6255FCAACF1
74109050FBA2602E72593FBCBFC26E726EE4AEF97B7632BC4F5F353B5C67FED2
3EA752A4A57B8F7FEFF1D7341D895F0A3A0BE1D8E3391970457A967EFF84F6D8
47750B1145B8CC5BD96EE7AA99DDC9E06939E383BDA41175233D58AD263EBF19
AFC0E2F840512D321166547B306C592B8A01E1FA2564B9A26DAC14256414E4C8
42616728D918C74D13C349F4186EC7B9708B86467425A6FDB3A396562F7EE4D8
40B43621744CF8A23A6E532649B66C2A0002DD04F8F39618E4F572819DD34837
B5A08E643FDCA1505AF6A1FA3DDFD1FA758013CAED8ACDDBBB334D664DFF5B53
9560176676ABB71BBD0EE56B4CC492C0652750227CEC6448917F1D3B8F16524A
31BBDECF90CDA6B612DF388A9212FB2132113864AD1BE806465A2C1ED067E79B
E68A26680AD2C996CD9F128C28F5C5C5228D251F77C1ED91237F98A21080E9BF
576EBB0EB0CA97C4D9DED3F1C5DD3AEA3D881AF3AA7E078DCEAE5D6F4B4FCE25
57D0D94DC425FFBD3CF897E944A87E982F96E284CFFA6D996AAB0BAB16B24DB1
5E18F9C1947039614D15BD60F70D8A7B0623D7F177B0A5427F51B64DD4A0C337
68A64C744D793212723016476D37FBDCF396295C8078E2AF0A6454C8A1E6590B
70290B984D6086F0E2FD627740F1CB66EFC37EFDB034C239141C496178366E92
0D053D401145FB72C4D5B314341015EEBE3AAEB5B5DF1555B5D61617D1B3C3FD
F59A6D549E90C2B52BB167E367719E39B1C30BEC479E4C61A852E409222A5CEB
4086967F7612EB470D4C111A052F774C8036553976AF8E350AAF3504570F4E4B
1E85792505D0A3B6E59AE4EA8602F6450EB51E9DC2826290E60DC268D6
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
%%BeginFont: CMSY10
%!PS-AdobeFont-1.1: CMSY10 1.0
%%CreationDate: 1991 Aug 15 07:20:57
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMSY10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.035 def
/isFixedPitch false def
end readonly def
/FontName /CMSY10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 6 /plusminus put
dup 15 /bullet put
readonly def
/FontBBox{-29 -960 1116 775}readonly def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA052F09F9C8ADE9D907C058B87E9B6964
7D53359E51216774A4EAA1E2B58EC3176BD1184A633B951372B4198D4E8C5EF4
A213ACB58AA0A658908035BF2ED8531779838A960DFE2B27EA49C37156989C85
E21B3ABF72E39A89232CD9F4237FC80C9E64E8425AA3BEF7DED60B122A52922A
221A37D9A807DD01161779DDE7D31FF2B87F97C73D63EECDDA4C49501773468A
27D1663E0B62F461F6E40A5D6676D1D12B51E641C1D4E8E2771864FC104F8CBF
5B78EC1D88228725F1C453A678F58A7E1B7BD7CA700717D288EB8DA1F57C4F09
0ABF1D42C5DDD0C384C7E22F8F8047BE1D4C1CC8E33368FB1AC82B4E96146730
DE3302B2E6B819CB6AE455B1AF3187FFE8071AA57EF8A6616B9CB7941D44EC7A
71A7BB3DF755178D7D2E4BB69859EFA4BBC30BD6BB1531133FD4D9438FF99F09
4ECC068A324D75B5F696B8688EEB2F17E5ED34CCD6D047A4E3806D000C199D7C
515DB70A8D4F6146FE068DC1E5DE8BC57036431151EC603C8BCFE359BBD953AD
5F3D999EF3D234C44BCC5EE4675F9CFE0EFD694DF5C2EAD314B917651C883458
2DAEEDBC416CB1144F6A0C2A45ABFFA44AA6C64CF269324AAFEA55C118E3C523
4AA4AF13108EE14EEC3E5B4FD5EEA6DE5605A44013C061FAA96B00FE216FA3B6
6AD5F5305A9E2771091AAD299760A75C150D3AB358BDB599DD41995128BBD365
11312EB158709799AD0ED0401D403F8B7A15FFD042B377E0273ABB503FEA492B
252B3C35D487C39286EF76BC9B5BDD3AD01FFF68F56B5D3B509B9290B2D1FABE
73F4B254CCBDF6E59B553E357BD886869601BF4E1CBCF79D41485C16CB967AE8
E3ECF3AE02F7D31EBB0572DED27E1F2F91D20D16D72A6034C67DFFF61CBFBF78
9D99529673D4DDCC1BE57614EFC5C01153D3BA9211158A692D0413749A30DBD7
511BE0177D419D1E0EEB910CC06337297532489490508A9BB57CF5B6ABB59BD0
910F15FD82964D2D7434
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
TeXDict begin 40258431 52099146 1000 600 600 (writeup.dvi)
@start /Fa 200[45 4[45 45 49[{}3 90.9091 /CMR10 rf /Fb
135[52 120[{}1 90.9091 /CMMI10 rf /Fc 240[45 8[71 6[{}2
90.9091 /CMSY10 rf /Fd 198[40 40 40 40 40 40 40 40 40
40 48[{TeXBase1Encoding ReEncodeFont}10 66.4176 /Courier
rf /Fe 167[53 69 1[53 2[49 1[40 53 1[65 1[53 28 24 53
53 40 44 53 49 49 53 65[{TeXBase1Encoding ReEncodeFont}18
72.7272 /Times-Roman rf /Ff 170[69 5[69 1[85 6[53 3[64
66[{TeXBase1Encoding ReEncodeFont}5 95.6413 /Times-Roman
rf /Fg 131[50 2[50 50 50 50 50 50 50 50 1[50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 9[50 1[50 50 50 50
3[50 50 3[50 3[50 50 50 1[50 50 1[50 1[50 6[50 1[50 50
50 1[50 50 50 45[{TeXBase1Encoding ReEncodeFont}47 83.022
/Courier-Oblique rf /Fh 130[50 1[50 50 50 50 50 50 50
50 50 50 1[50 50 50 50 50 50 1[50 50 50 50 50 50 50 50
50 1[50 1[50 50 50 1[50 4[50 50 2[50 50 1[50 5[50 50
50 50 50 50 50 2[50 50 1[50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 1[50 50 50 2[50 50 50 50 50 33[{
TeXBase1Encoding ReEncodeFont}69 83.022 /Courier rf /Fi
133[40 45 45 66 45 51 30 35 40 1[51 45 51 76 25 51 1[25
51 45 30 40 51 40 51 45 7[66 3[66 61 51 66 1[56 71 66
86 3[35 7[66 6[30 7[45 50[{TeXBase1Encoding ReEncodeFont}37
90.9091 /Times-Bold rf /Fj 133[55 1[55 1[55 55 55 55
55 1[55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
1[55 2[55 4[55 1[55 1[55 55 2[55 55 55 1[55 3[55 55 55
55 55 55 55 55 2[55 2[55 55 55 1[55 55 55 55 55 55 55
55 55 55 55 2[55 55 2[55 55 55 1[55 33[{TeXBase1Encoding ReEncodeFont}
62 90.9091 /Courier rf /Fk 134[40 40 61 40 45 25 35 35
1[45 45 45 66 25 40 1[25 45 45 25 40 45 40 45 45 24[66
5[56 20[30 41[45 3[{TeXBase1Encoding ReEncodeFont}27
90.9091 /Times-Italic rf /Fl 104[91 2[40 40 24[40 45
45 66 45 45 25 35 30 45 45 45 45 71 25 45 25 25 45 45
30 40 45 40 45 40 30 2[30 1[30 1[66 1[86 1[66 56 51 61
66 51 66 66 1[56 66 1[30 66 66 51 56 66 61 61 66 1[40
3[25 25 45 45 45 45 45 45 45 45 45 45 25 23 30 23 1[45
30 30 30 5[30 29[51 51 2[{TeXBase1Encoding ReEncodeFont}77
90.9091 /Times-Roman rf /Fm 107[60 26[60 2[60 66 40 47
53 1[66 60 66 100 33 66 1[33 66 60 1[53 66 53 66 60 11[86
80 66 2[73 93 86 1[80 2[47 93 93 73 1[86 86 80 7[40 4[60
60 60 60 60 60 6[40 40 36[66 3[{TeXBase1Encoding ReEncodeFont}45
119.552 /Times-Bold rf /Fn 138[72 40 56 48 1[72 72 72
112 40 2[40 72 72 48 64 72 1[72 64 12[88 80 2[80 2[128
88 5[80 1[104 1[96 104 6[40 72 72 2[72 1[72 72 72 72
2[48 36 44[{TeXBase1Encoding ReEncodeFont}36 143.462
/Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
 end
%%EndSetup
%%Page: 1 1
TeXDict begin 1 0 bop 1355 937 a Fn(15-213,)34 b(Spring)h(2010)827
1120 y(Lab)g(Assignment)e(L3:)44 b(The)35 b(Buf)l(fer)f(Bomb)384
1303 y(Assigned:)42 b(Thu,)35 b(Feb)g(11th,)g(Due:)43
b(Thu,)35 b(Feb)g(25,)h(11:59PM)408 1485 y(Last)f(Possible)f(T)-5
b(ime)35 b(to)g(T)-6 b(urn)34 b(in:)44 b(Sun,)35 b(Feb)g(28,)h(11:59PM)
0 2208 y Fm(Intr)n(oduction)0 2455 y Fl(This)e(assignment)j(will)d
(help)h(you)f(de)n(v)o(elop)i(a)e(detailed)i(understanding)j(of)34
b(IA-32)g(calling)i(con)l(v)o(entions)i(and)d(stack)0
2567 y(or)n(ganization.)i(It)25 b(in)l(v)n(olv)o(es)i(applying)h(a)c
(series)i(of)f Fk(b)n(uf)n(fer)i(o)o(ver\003ow)g(attac)n(ks)g
Fl(on)e(an)g(e)o(x)o(ecutable)i(\002le)e Fj(bufbomb)c
Fl(in)k(the)0 2680 y(lab)f(directory)-6 b(.)0 2832 y
Fi(Note:)44 b Fl(In)32 b(this)f(lab,)i(you)f(will)f(gain)g(\002rsthand)
i(e)o(xperience)h(with)d(one)g(of)g(the)h(methods)g(commonly)g(used)g
(to)g(e)o(xploit)0 2945 y(security)d(weaknesses)g(in)d(operating)j
(systems)f(and)f(netw)o(ork)h(serv)o(ers.)39 b(Our)26
b(purpose)j(is)d(to)h(help)g(you)g(learn)h(about)g(the)0
3058 y(runtime)h(operation)h(of)e(programs)i(and)e(to)g(understand)j
(the)d(nature)h(of)f(this)g(form)g(of)g(security)i(weakness)f(so)f
(that)g(you)0 3171 y(can)e(a)n(v)n(oid)g(it)f(when)h(you)f(write)h
(system)g(code.)34 b(W)-7 b(e)24 b(do)i(not)f(condone)j(the)d(use)h(of)
f(this)h(or)f(an)o(y)g(other)h(form)f(of)h(attack)g(to)0
3284 y(gain)e(unauthorized)j(access)e(to)f(an)o(y)f(system)h
(resources.)32 b(There)23 b(are)h(criminal)h(statutes)g(go)o(v)o
(erning)h(such)e(acti)n(vities.)0 3616 y Fm(Logistics)0
3862 y Fl(As)f(usual,)h(this)g(is)g(an)f(indi)n(vidual)j(project.)0
4014 y(Ev)o(en)19 b(though)j(you)e(will)g(be)g(e)o(xploiting)i(a)d
(program)i(that)g(uses)f(Intel')-5 b(s)21 b(32-bit)g(calling)h(con)l(v)
o(ention,)h(you)e(will)e(be)h(running)0 4127 y(this)27
b(lab)f(on)h(one)g(of)f(the)g(class')-5 b(s)28 b(64-bit)g(Fish)e
(machines)i(\(the)f(same)f(machines)i(you)f(used)g(for)f(Lab)g(2\).)37
b(W)-7 b(e)25 b(generated)0 4240 y(the)j(lab)f(using)h
Fj(gcc)p Fl(')-5 b(s)26 b Fj(-m32)f Fl(\003ag,)i(so)g(all)h(code)g
(produced)h(by)f(the)f(compiler)i(follo)n(ws)f(IA-32)f(rules.)41
b(This)27 b(should)i(be)0 4353 y(enough)c(to)e(con)l(vince)j(you)d
(that)h(the)f(compiler)h(can)g(use)f(an)o(y)g(calling)i(con)l(v)o
(ention)h(it)d(w)o(ants,)g(so)g(long)h(as)f(it')-5 b(s)23
b(consistent.)0 4505 y(Clari\002cations)j(and)e(corrections)i(will)d
(be)h(posted)h(on)f(the)g(Course)g(F)-7 b(A)i(Q)22 b(P)o(age.)0
4837 y Fm(Hand)31 b(Out)f(Instructions)0 5083 y Fl(Y)-10
b(ou)23 b(can)h(obtain)h(your)g(b)n(uf)n(fer)f(bomb)g(from)g(the)f
(Autolab)i(site)218 5334 y Fj(http://autolab.)o(cs)o(.cm)o(u.)o(ed)o(u)
1924 5712 y Fl(1)p eop end
%%Page: 2 2
TeXDict begin 2 1 bop 0 573 a Fl(After)26 b(logging)i(in)e(to)f
(Autolab,)j(select)f(\223L3)e(-)g(b)n(u\003ab\224)i(and)g(\223S4)e(-)g
(Do)n(wnload)i(lab)f(materials\224)i(and)e(then)h(hit)f(the)g
(\223Go\224)0 686 y(b)n(utton.)k(The)24 b(Autolab)g(serv)o(er)h(will)e
(return)i(a)e Fj(tar)e Fl(\002le)i(called)i Fj(buflab-handout)o(.ta)o
(r)16 b Fl(to)24 b(your)g(bro)n(wser)-5 b(.)0 838 y(Start)27
b(by)g(cop)o(ying)j Fj(buflab-handout.)o(ta)o(r)20 b
Fl(to)27 b(a)g(\(protected\))j(directory)g(in)d(which)h(you)g(plan)g
(to)f(do)g(your)h(w)o(ork.)0 951 y(Then)c(gi)n(v)o(e)g(the)g(command)h
(\223)p Fj(tar)54 b(xvf)f(buflab-handout)o(.ta)o(r)p
Fl(\224.)23 b(As)g(usual,)i(do)f Fi(not)g Fl(untar)h(the)f(handout)i
(on)e(a)0 1064 y(machine)c(other)g(than)f(an)g(Andre)n(w)f(Linux)h
(machine)h(or)f(Fish)f(machine)i(unless)g(you)f(kno)n(w)g(you')-5
b(re)21 b(using)f(tools)f(that)g(don')n(t)0 1177 y(mangle)25
b(line)f(endings)i(or)d(\002le)h(permissions.)32 b(This)23
b(will)h(create)h(a)e(directory)j(called)f Fj(buflab-handout)17
b Fl(containing)0 1289 y(the)24 b(follo)n(wing)h(three)f(e)o(x)o
(ecutable)i(\002les:)45 1516 y Fi(b)n(ufbomb)p Fl(:)i(The)23
b(program)i(you)f(will)f(attack.)45 1704 y Fi(mak)o(ecookie)p
Fl(:)31 b(Generates)25 b(a)e(\223cookie\224)j(based)e(on)g(your)g
(userid.)45 1891 y Fi(hex2raw)p Fl(:)30 b(A)23 b(utility)i(to)e(help)h
(con)l(v)o(ert)i(between)e(string)h(formats.)0 2118 y(In)i(the)g(follo)
n(wing)i(instructions,)i(we)26 b(will)h(assume)h(that)g(you)f(ha)n(v)o
(e)h(copied)h(the)e(three)h(programs)h(to)e(a)f(protected)k(local)0
2231 y(directory)-6 b(,)26 b(and)e(that)g(you)g(are)g(e)o(x)o(ecuting)h
(them)f(in)f(that)h(local)h(directory)-6 b(.)0 2563 y
Fm(Userids)30 b(and)h(Cookies)0 2809 y Fl(Phases)d(of)g(this)g(lab)g
(will)f(require)i(a)f(slightly)h(dif)n(ferent)h(solution)g(from)d(each)
i(student.)42 b(The)28 b(correct)h(solution)h(will)d(be)0
2922 y(based)e(on)e(your)i(Andre)n(w)e(ID.)0 3061 y(A)28
b Fk(cookie)j Fl(is)e(a)g(string)i(of)e(eight)h(he)o(xadecimal)i
(digits)f(that)f(is)f(\(with)g(high)i(probability\))h(unique)f(to)f
(your)g(userid)h(\(i.e.,)0 3160 y(Andre)n(w)23 b(user)h(name\).)29
b(Y)-10 b(ou)23 b(can)g(generate)i(your)f(cookie)h(with)e(the)g
Fj(makecookie)18 b Fl(program)25 b(gi)n(ving)f(your)g(user)g(name)0
3260 y(as)f(the)h(ar)n(gument.)31 b(F)o(or)23 b(e)o(xample:)0
3473 y Fh(unix>)49 b Fg(./makecookie)e(bovik@ANDREW.CMU.EDU)0
3573 y Fh(0x1005b2b7)0 3800 y Fl(In)28 b(four)h(of)f(your)h(\002)n(v)o
(e)e(b)n(uf)n(fer)i(attacks,)i(your)e(objecti)n(v)o(e)h(will)e(be)g(to)
g(mak)o(e)g(your)h(cookie)h(sho)n(w)e(up)g(in)g(places)i(where)e(it)0
3913 y(ordinarily)e(w)o(ould)e(not.)0 4245 y Fm(The)33
b Ff(B)5 b(U)h(F)g(B)g(O)g(M)g(B)32 b Fm(Pr)n(ogram)0
4491 y Fl(The)e Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g Fl(program)g(reads)f(a)e
(string)j(from)e(standard)i(input.)43 b(It)28 b(does)h(so)f(with)g(the)
g(function)j Fj(getbuf)24 b Fl(de\002ned)0 4604 y(belo)n(w:)120
4842 y Fd(1)49 b Fh(int)g(getbuf\(\))120 4942 y Fd(2)g
Fh({)120 5041 y Fd(3)248 b Fh(char)50 b(buf[32];)120
5141 y Fd(4)248 b Fh(Gets\(buf\);)120 5241 y Fd(5)g Fh(return)49
b(1;)120 5340 y Fd(6)g Fh(})1924 5712 y Fl(2)p eop end
%%Page: 3 3
TeXDict begin 3 2 bop 0 573 a Fl(The)26 b(function)j
Fj(Gets)24 b Fl(is)i(similar)i(to)e(the)h(standard)i(library)f
(function)h Fj(gets)p Fl(\227it)24 b(reads)k(a)e(string)i(from)e
(standard)j(input)0 686 y(\(terminated)h(by)d(`)p Fj(\\n)p
Fl(')f(or)h(end-of-\002le\))j(and)e(stores)g(it)f(\(along)i(with)e(a)g
(null)h(terminator\))i(at)d(the)g(speci\002ed)i(destination.)0
799 y(In)23 b(this)i(code,)f(you)g(can)g(see)f(that)i(the)e
(destination)k(is)c(an)h(array)g Fj(buf)e Fl(ha)n(ving)j(suf)n
(\002cient)g(space)g(for)e(32)h(characters.)0 951 y Fj(Gets)g
Fl(\(and)k Fj(gets)p Fl(\))c(grabs)k(a)f(string)h(of)n(f)f(the)g(input)
h(stream)f(and)h(stores)g(it)e(into)i(its)f(destination)j(address)f
(\(in)e(this)g(case)0 1064 y Fj(buf)p Fl(\).)f(Ho)n(we)n(v)o(er)l(,)c
Fj(Gets\(\))d Fl(has)k(no)f(w)o(ay)g(of)g(determining)j(whether)e
Fj(buf)d Fl(is)i(lar)n(ge)i(enough)g(to)e(store)h(the)g(whole)f(input.)
0 1177 y(It)35 b(simply)h(copies)g(the)f(entire)i(input)f(string,)j
(possibly)e(o)o(v)o(errunning)h(the)d(bounds)i(of)e(the)h(storage)g
(allocated)i(at)d(the)0 1289 y(destination.)0 1442 y(If)26
b(the)g(string)h(typed)h(by)e(the)g(user)h(to)f Fj(getbuf)c
Fl(is)k(no)g(more)g(than)h(31)f(characters)j(long,)e(it)f(is)f(clear)i
(that)g Fj(getbuf)22 b Fl(will)0 1554 y(return)j(1,)e(as)g(sho)n(wn)h
(by)g(the)f(follo)n(wing)i(e)o(x)o(ecution)h(e)o(xample:)0
1793 y Fh(unix>)49 b Fg(./bufbomb)f(-t)h(bovik@ANDREW.CMU.EDU)0
1892 y Fh(Type)g(string:)g Fg(I)g(love)g(15-213.)0 1992
y Fh(Dud:)g(getbuf)g(returned)f(0x1)0 2244 y Fl(T)-7
b(ypically)25 b(an)e(error)i(occurs)g(if)e(we)g(type)h(a)f(longer)i
(string:)0 2482 y Fh(unix>)49 b Fg(./bufbomb)f(-t)h
(bovik@ANDREW.CMU.EDU)0 2582 y Fh(Type)g(string:)g Fg(It)g(is)g(easier)
g(to)h(love)f(this)g(class)g(when)g(you)g(are)g(a)h(TA.)0
2681 y Fh(Ouch!:)f(You)g(caused)g(a)g(segmentation)f(fault!)0
2933 y Fl(As)27 b(the)i(error)g(message)g(indicates,)j(o)o(v)o
(errunning)f(the)d(b)n(uf)n(fer)h(typically)i(causes)f(the)e(program)h
(state)g(to)f(be)h(corrupted,)0 3046 y(leading)24 b(to)e(a)f(memory)h
(access)h(error)-5 b(.)29 b(Y)-10 b(our)22 b(task)h(is)e(to)h(be)g
(more)g(cle)n(v)o(er)h(with)e(the)i(strings)g(you)f(feed)j
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)f Fl(so)e(that)0 3159 y(it)h(does)i(more)e
(interesting)k(things.)j(These)24 b(are)f(called)i Fk(e)n(xploit)h
Fl(strings.)2 3311 y(B)s Fe(U)t(F)t(B)t(O)t(M)t(B)g Fl(tak)o(es)f(se)n
(v)o(eral)f(dif)n(ferent)i(command)e(line)g(ar)n(guments:)0
3538 y Fj(-t)e Fk(userid)p Fi(:)48 b Fl(Operate)27 b(the)f(bomb)h(for)f
(the)h(indicated)h(userid.)39 b(Remember)l(,)27 b(your)g(userid)g(is)f
(your)h(andre)n(wID)g(follo)n(wed)227 3651 y(by)d Fj(@ANDREW.CMU.EDU)o
Fl(.)17 b(Y)-10 b(ou)23 b(should)i(al)o(w)o(ays)f(pro)o(vide)h(this)g
(ar)n(gument)g(for)f(se)n(v)o(eral)g(reasons:)336 3863
y Fc(\017)46 b Fl(It)24 b(is)f(required)j(to)d(log)h(your)g(successful)
j(attacks)e(to)e(the)h(Autolab)h(serv)o(er)-5 b(.)336
4009 y Fc(\017)48 b Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)30 b
Fl(determines)f(the)f(cookie)g(you)g(will)f(be)g(using)h(based)h(on)e
(your)h(userid,)h(as)e(does)h(the)g(program)429 4122
y Fe(M)t(A)t(K)t(E)t(C)t(O)t(O)t(K)t(I)t(E)r Fl(.)336
4268 y Fc(\017)46 b Fl(W)-7 b(e)25 b(ha)n(v)o(e)h(b)n(uilt)g(features)i
(into)g Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g Fl(so)d(that)h(some)g(of)f(the)h
(k)o(e)o(y)f(stack)i(addresses)h(you)e(will)f(need)h(to)427
4381 y(use)e(depend)h(on)f(your)g(userid')-5 b(s)26 b(cookie.)0
4594 y Fj(-h)p Fi(:)45 b Fl(Print)23 b(list)h(of)g(possible)h(command)g
(line)f(ar)n(guments)0 4781 y Fj(-n)p Fi(:)45 b Fl(Operate)24
b(in)g(\223Nitro\224)g(mode,)g(as)f(is)g(used)i(in)e(Le)n(v)o(el)g(4)g
(belo)n(w)-6 b(.)0 5008 y(At)20 b(this)h(point,)h(you)f(should)h(think)
g(about)g(the)f(x86)g(stack)h(structure)h(a)d(bit)h(and)g(\002gure)g
(out)g(what)f(entries)i(of)f(the)g(stack)g(you)0 5121
y(will)29 b(be)g(tar)n(geting.)47 b(Y)-10 b(ou)29 b(may)g(also)g(w)o
(ant)g(to)g(think)h(about)h Fk(e)n(xactly)f Fl(why)f(the)g(last)g(e)o
(xample)h(created)h(a)d(se)o(gmentation)0 5234 y(f)o(ault,)c(although)i
(this)e(is)g(less)g(clear)-5 b(.)1924 5712 y(3)p eop
end
%%Page: 4 4
TeXDict begin 4 3 bop 0 573 a Fl(Y)-10 b(our)20 b(e)o(xploit)h(strings)
g(will)e(typically)j(contain)f(byte)g(v)n(alues)f(that)h(do)e(not)h
(correspond)j(to)c(the)h(ASCII)e(v)n(alues)j(for)f(printing)0
686 y(characters.)72 b(The)37 b(program)j Fe(H)t(E)t(X)t
Fl(2)t Fe(R)t(A)m(W)h Fl(can)c(help)h(you)g(generate)h(these)f
Fk(r)o(aw)e Fl(strings.)71 b(It)37 b(tak)o(es)h(as)f(input)h(a)f
Fk(he)n(x-)0 799 y(formatted)29 b Fl(string.)43 b(In)28
b(this)g(format,)h(each)f(byte)h(v)n(alue)f(is)g(represented)j(by)d(tw)
o(o)f(he)o(x)h(digits.)42 b(F)o(or)27 b(e)o(xample,)j(the)e(string)0
912 y(\223)p Fj(012345)p Fl(\224)23 b(could)k(be)f(entered)i(in)e(he)o
(x)g(format)g(as)g(\223)p Fj(30)54 b(31)g(32)g(33)f(34)h(35)p
Fl(.)-6 b(\224)34 b(\(Recall)27 b(that)f(the)g(ASCII)f(code)i(for)0
1024 y(decimal)e(digit)f Fb(x)f Fl(is)g Fj(0x3)p Fb(x)p
Fl(.\))0 1177 y(The)j(he)o(x)h(characters)i(you)f(pass)h
Fe(H)t(E)t(X)t Fl(2)t Fe(R)t(A)m(W)i Fl(should)d(be)f(separated)i(by)e
(whitespace)h(\(blanks)h(or)e(ne)n(wlines\).)39 b(I)26
b(recom-)0 1289 y(mend)e(separating)j(dif)n(ferent)f(parts)f(of)g(your)
g(e)o(xploit)g(string)h(with)d(ne)n(wlines)j(while)e(you')-5
b(re)26 b(w)o(orking)g(on)e(it.)32 b Fe(H)t(E)t(X)t Fl(2)t
Fe(R)t(A)m(W)0 1402 y Fl(also)24 b(supports)i(C-style)e(block)h
(comments,)f(so)g(you)g(can)g(mark)f(of)n(f)h(sections)h(of)f(your)g(e)
o(xploit)h(string.)30 b(F)o(or)23 b(e)o(xample:)0 1641
y Fh(bf)49 b(66)h(7b)f(32)h(78)f(/)797 1656 y(*)897 1641
y(mov)198 b($0x78327b66,\045edi)2092 1656 y(*)2142 1641
y(/)0 1892 y Fl(Be)22 b(sure)i(to)g(lea)n(v)o(e)g(space)g(around)h
(both)f(the)f(starting)j(and)d(ending)i(comment)f(strings)h(\(/*,)e
(*/\))h(so)f(the)o(y)h(will)e(be)i(properly)0 2005 y(ignored.)0
2276 y(If)k(you)h(generate)h(a)e(he)o(x-formatted)j(e)o(xploit)f
(string)f(in)f(the)h(\002le)e Fj(exploit.txt)p Fl(,)d(you)29
b(can)f(apply)i(the)e(ra)o(w)f(string)j(to)2 2388 y Fe(B)s(U)t(F)t(B)t
(O)t(M)t(B)c Fl(in)e(se)n(v)o(eral)g(dif)n(ferent)i(w)o(ays:)114
2602 y(1.)45 b(Y)-10 b(ou)24 b(can)f(set)h(up)g(a)f(series)i(of)e
(pipes)i(to)e(pass)h(the)g(string)h(through)j Fe(H)t(E)t(X)t
Fl(2)t Fe(R)t(A)m(W)r Fl(.)227 2814 y Fh(unix>)49 b Fg(cat)g
(exploit.txt)f(|)i(./hex2raw)e(|)i(./bufbomb)e(-t)h
(bovik@ANDREW.CMU.EDU)114 3025 y Fl(2.)c(Y)-10 b(ou)24
b(can)f(store)i(the)f(ra)o(w)e(string)j(in)f(a)f(\002le)g(and)h(use)g
(I/O)e(redirection)27 b(to)c(supply)j(it)d(to)i Fe(B)s(U)t(F)t(B)t(O)t
(M)t(B)r Fl(:)227 3237 y Fh(unix>)49 b Fg(./hex2raw)f(<)i(exploit.txt)e
(>)h(exploit-raw.txt)227 3337 y Fh(unix>)g Fg(./bufbomb)f(-t)i
(bovik@ANDREW.CMU.EDU)c(<)j(exploit-raw.txt)227 3548
y Fl(This)24 b(approach)i(can)d(also)i(be)e(used)i(when)e(running)28
b Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)e Fl(from)d(within)j Fe(G)t(D)t(B)r
Fl(:)227 3760 y Fh(unix>)49 b Fg(gdb)g(bufbomb)227 3860
y Fh(\(gdb\))g Fg(run)g(-t)h(bovik@ANDREW.CMU.EDU)c(<)k
(exploit-raw.txt)0 4086 y Fi(Important)24 b(points:)136
4338 y Fc(\017)46 b Fl(Y)-10 b(our)29 b(e)o(xploit)h(string)g(must)e
(not)h(contain)i(byte)e(v)n(alue)g Fj(0x0A)d Fl(at)j(an)o(y)f
(intermediate)k(position,)f(since)f(this)f(is)g(the)227
4451 y(ASCII)i(code)i(for)f(ne)n(wline)h(\(`)p Fj(\\n)p
Fl('\).)54 b(When)32 b Fj(Gets)d Fl(encounters)35 b(this)e(byte,)i(it)c
(will)h(assume)h(you)g(intended)h(to)227 4564 y(terminate)25
b(the)f(string.)136 4752 y Fc(\017)48 b Fe(H)t(E)t(X)t
Fl(2)t Fe(R)t(A)m(W)33 b Fl(e)o(xpects)d(tw)o(o-digit)g(he)o(x)f(v)n
(alues)h(separated)i(by)d(a)f(whitespace.)46 b(So)28
b(if)h(you)g(w)o(ant)g(to)g(create)h(a)e(byte)227 4864
y(with)23 b(a)g(he)o(x)g(v)n(alue)h(of)g(0,)e(you)i(need)g(to)f
(specify)i(00.)k(T)-7 b(o)22 b(create)i(the)g(w)o(ord)f
Fj(0xDEADBEEF)18 b Fl(you)24 b(should)h(pass)f(DE)227
4977 y(AD)e(BE)g(EF)g(to)j Fe(H)t(E)t(X)t Fl(2)t Fe(R)t(A)m(W)r
Fl(.)0 5229 y(When)f(you)f(correctly)j(solv)o(e)e(one)f(of)h(the)f(le)n
(v)o(els,)j Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g Fl(will)c(automatically)27
b(send)d(a)f(noti\002cation)i(to)e(the)h(Autolab)0 5342
y(serv)o(er)-5 b(.)40 b(The)27 b(serv)o(er)h(will)e(test)i(your)g(e)o
(xploit)g(string)g(to)f(mak)o(e)g(sure)h(it)f(really)h(w)o(orks,)g(and)
g(it)e(will)h(update)i(the)e(Autolab)0 5455 y(W)-7 b(eb)23
b(status)i(page)f(indicating)j(that)d(your)g(userid)h(\(listed)g(by)f
(nickname\))h(has)f(completed)h(this)g(le)n(v)o(el.)1924
5712 y(4)p eop end
%%Page: 5 5
TeXDict begin 5 4 bop 0 573 a Fl(Unlik)o(e)21 b(the)f(Bomb)f(Lab,)h
(there)h(is)e(no)h(penalty)i(for)e(making)h(mistak)o(es)g(in)f(this)g
(lab)l(.)28 b(Feel)20 b(free)g(to)g(\002re)f(a)o(w)o(ay)h(at)h
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)0 686 y Fl(with)h(an)o(y)h(string)h(you)f
(lik)o(e.)29 b(Of)22 b(course,)i(you)f(shouldn')n(t)j(brute)e(force)f
(this)g(lab)g(either)l(,)h(since)g(it)e(w)o(ould)i(tak)o(e)f(longer)h
(than)0 799 y(you)g(ha)n(v)o(e)g(to)g(do)f(the)h(assignment)i(and)e
(probably)i(cause)f(netw)o(ork)f(problems.)0 951 y Fi(IMPOR)l(T)-8
b(ANT)p Fl(:)19 b(There)j(are)h(man)o(y)f(w)o(ays)g(to)g(solv)o(e)g
(the)h(stages)g(in)f(this)h(lab,)f(ho)n(we)n(v)o(er)g(the)g
(instructions)k(belo)n(w)c(instruct)0 1064 y(you)j(to)f(solv)o(e)h
(each)h(stage)f(in)f(a)g(particular)j(w)o(ay)-6 b(.)31
b Fi(Y)-10 b(ou)24 b(MUST)e(solv)o(e)j(the)f(stages)i(in)d(the)h
(method)g(mentioned)f(belo)o(w)0 1177 y(or)j(y)n(ou)f(will)h(not)f(r)n
(ecei)o(v)o(e)j(points)e(f)n(or)g(that)g(stage)p Fl(.)37
b(W)-7 b(e)25 b(will)g(notify)j(you)e(after)h(the)f(\002nal)g
(submission)i(date)f(that)f(your)0 1289 y(solution)f(is)e(in)l(v)n
(alid,)h(and)f(e)n(v)o(en)g(if)g(Autolab)h(tells)f(you)g(that)h(you)f
(ha)n(v)o(e)g(full)h(credit,)g(you)f(will)f(lose)i(points)g(for)f(that)
g(stage.)0 1402 y(Please)h(see)g(the)g Fk(Hac)n(king)h(Bu\003ab)f
Fl(section)h(belo)n(w)f(for)f(more)h(information.)0 1732
y Fm(Le)n(v)o(el)30 b(0:)36 b(Candle)c(\(10)d(pts\))0
1979 y Fl(The)23 b(function)j Fj(getbuf)20 b Fl(is)j(called)i(within)h
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g Fl(by)e(a)f(function)j
Fj(test)21 b Fl(ha)n(ving)k(the)f(follo)n(wing)h(C)d(code:)120
2207 y Fd(1)49 b Fh(void)g(test\(\))120 2307 y Fd(2)g
Fh({)120 2406 y Fd(3)248 b Fh(int)50 b(val;)120 2506
y Fd(4)248 b Fh(volatile)49 b(int)g(local)g(=)h(0xdeadbeef;)120
2606 y Fd(5)248 b Fh(val)50 b(=)f(getbuf\(\);)120 2705
y Fd(6)248 b Fh(/)458 2720 y(*)558 2705 y(Check)49 b(for)g(corrupted)f
(stack)1853 2720 y(*)1903 2705 y(/)120 2805 y Fd(7)248
b Fh(if)50 b(\(local)f(!=)g(0xdeadbeef\))f({)120 2904
y Fd(8)448 b Fh(printf\("Sabotaged!:)46 b(the)j(stack)g(has)g(been)g
(corrupted\\n"\);)120 3004 y Fd(9)248 b Fh(})80 3104
y Fd(10)g Fh(else)50 b(if)f(\(val)g(==)g(cookie\))g({)80
3203 y Fd(11)448 b Fh(printf\("Boom!:)47 b(getbuf)i(returned)f
(0x\045x\\n",)g(val\);)80 3303 y Fd(12)448 b Fh(validate\(3\);)80
3403 y Fd(13)248 b Fh(})80 3502 y Fd(14)g Fh(else)50
b({)80 3602 y Fd(15)448 b Fh(printf\("Dud:)47 b(getbuf)i(returned)f
(0x\045x\\n",)h(val\);)80 3701 y Fd(16)248 b Fh(})80
3801 y Fd(17)49 b Fh(})0 4043 y Fl(When)22 b Fj(getbuf)c
Fl(e)o(x)o(ecutes)23 b(its)f(return)h(statement)h(\(line)e(5)g(of)f
Fj(getbuf)p Fl(\),)e(the)j(program)h(ordinarily)h(resumes)f(e)o(x)o
(ecution)0 4156 y(within)c(function)h Fj(test)c Fl(\(at)i(line)h(7)e
(of)h(this)h(function\).)30 b(W)-7 b(e)17 b(w)o(ant)h(to)g(change)i
(this)f(beha)n(vior)-5 b(.)29 b(W)l(ithin)19 b(the)g(\002le)e
Fj(bufbomb)p Fl(,)0 4269 y(there)24 b(is)g(a)f(function)j
Fj(smoke)20 b Fl(ha)n(ving)25 b(the)f(follo)n(wing)h(C)e(code:)0
4497 y Fh(void)49 b(smoke\(\))0 4597 y({)199 4696 y(printf\("Smoke!:)e
(You)j(called)e(smoke\(\)\\n"\);)199 4796 y(validate\(0\);)199
4896 y(exit\(0\);)0 4995 y(})0 5237 y Fl(Y)-10 b(our)26
b(task)g(is)g(to)g(get)i Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g
Fl(to)e(e)o(x)o(ecute)h(the)f(code)h(for)f Fj(smoke)d
Fl(when)j Fj(getbuf)c Fl(e)o(x)o(ecutes)27 b(its)f(return)i(statement,)
0 5350 y(rather)e(than)f(returning)i(to)d Fj(test)p Fl(.)29
b(Note)24 b(that)h(your)g(e)o(xploit)h(string)g(may)e(also)h(corrupt)h
(parts)g(of)e(the)h(stack)g(not)g(directly)0 5463 y(related)g(to)f
(this)g(stage,)g(b)n(ut)g(this)g(will)f(not)h(cause)h(a)e(problem,)h
(since)h Fj(smoke)20 b Fl(causes)25 b(the)f(program)h(to)e(e)o(xit)h
(directly)-6 b(.)1924 5712 y(5)p eop end
%%Page: 6 6
TeXDict begin 6 5 bop 0 573 a Fi(Some)23 b(Advice)p Fl(:)136
787 y Fc(\017)46 b Fl(All)26 b(the)g(information)i(you)f(need)g(to)f
(de)n(vise)h(your)g(e)o(xploit)g(string)g(for)f(this)h(le)n(v)o(el)f
(can)h(be)f(determined)i(by)e(e)o(xam-)227 900 y(ining)f(a)e
(disassembled)k(v)o(ersion)e(of)g Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)r
Fl(.)k(Use)23 b Fj(objdump)52 b(-d)22 b Fl(to)h(get)h(this)g
(dissembled)i(v)o(ersion.)136 1082 y Fc(\017)46 b Fl(Be)23
b(careful)i(about)g(byte)f(ordering.)136 1265 y Fc(\017)46
b Fl(Y)-10 b(ou)22 b(might)h(w)o(ant)g(to)f(use)j Fe(G)t(D)t(B)e
Fl(to)g(step)g(the)f(program)i(through)g(the)f(last)g(fe)n(w)e
(instructions)26 b(of)d Fj(getbuf)18 b Fl(to)23 b(mak)o(e)227
1378 y(sure)h(it)g(is)f(doing)i(the)f(right)g(thing.)136
1560 y Fc(\017)46 b Fl(The)31 b(placement)h(of)f Fj(buf)e
Fl(within)i(the)g(stack)h(frame)f(for)g Fj(getbuf)c Fl(depends)33
b(on)e(which)g(v)o(ersion)i(of)f Fe(G)t(C)t(C)g Fl(w)o(as)227
1673 y(used)25 b(to)e(compile)i Fj(bufbomb)p Fl(,)19
b(so)24 b(you)g(will)f(ha)n(v)o(e)h(to)f(read)i(some)e(assembly)i(to)f
(\002gure)g(out)g(its)f(true)h(location.)0 2002 y Fm(Le)n(v)o(el)30
b(1:)36 b(Sparkler)c(\(10)d(pts\))0 2249 y Fl(W)l(ithin)c(the)e(\002le)
g Fj(bufbomb)d Fl(there)k(is)g(also)g(a)f(function)j
Fj(fizz)21 b Fl(ha)n(ving)k(the)f(follo)n(wing)h(C)d(code:)0
2472 y Fh(void)49 b(fizz\(int)f(val\))0 2571 y({)199
2671 y(if)i(\(val)f(==)g(cookie\))g({)399 2771 y(printf\("Fizz!:)e(You)
i(called)g(fizz\(0x\045x\)\\n",)e(val\);)399 2870 y(validate\(1\);)199
2970 y(})j(else)399 3070 y(printf\("Misfire:)c(You)k(called)e
(fizz\(0x\045x\)\\n",)f(val\);)199 3169 y(exit\(0\);)0
3269 y(})0 3505 y Fl(Similar)33 b(to)g(Le)n(v)o(el)g(0,)i(your)f(task)f
(is)g(to)h(get)h Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)h Fl(to)d(e)o(x)o(ecute)h
(the)f(code)h(for)g Fj(fizz)c Fl(rather)35 b(than)e(returning)j(to)0
3618 y Fj(test)p Fl(.)45 b(In)30 b(this)g(case,)i(ho)n(we)n(v)o(er)l(,)
f(you)g(must)e(mak)o(e)h(it)g(appear)h(to)f Fj(fizz)d
Fl(as)j(if)f(you)h(ha)n(v)o(e)h(passed)g(your)g(cookie)g(as)f(its)0
3731 y(ar)n(gument.)h(Ho)n(w)22 b(can)i(you)g(do)f(this?)0
3883 y Fi(Some)g(Advice)p Fl(:)136 4097 y Fc(\017)46
b Fl(Note)30 b(that)g(the)f(program)i(w)o(on')n(t)f(really)h(call)f
Fj(fizz)p Fl(\227it)d(will)i(simply)h(e)o(x)o(ecute)g(its)g(code.)47
b(This)29 b(has)h(important)227 4210 y(implications)d(for)c(where)h(on)
g(the)g(stack)g(you)g(w)o(ant)g(to)f(place)i(your)f(cookie.)0
4539 y Fm(Le)n(v)o(el)30 b(2:)36 b(Fir)n(ecrack)o(er)31
b(\(15)e(pts\))0 4785 y Fl(A)e(much)i(more)g(sophisticated)j(form)c(of)
h(b)n(uf)n(fer)g(attack)h(in)l(v)n(olv)o(es)h(supplying)h(a)c(string)h
(that)g(encodes)i(actual)f(machine)0 4898 y(instructions.)36
b(The)24 b(e)o(xploit)i(string)g(then)f(o)o(v)o(erwrites)h(the)f
(return)h(pointer)g(with)f(the)g(starting)h(address)h(of)d(these)i
(instruc-)0 5011 y(tions.)32 b(When)24 b(the)h(calling)g(function)i
(\(in)d(this)h(case)g Fj(getbuf)p Fl(\))c(e)o(x)o(ecutes)k(its)f
Fj(ret)e Fl(instruction,)28 b(the)c(program)h(will)f(start)0
5124 y(e)o(x)o(ecuting)k(the)d(instructions)k(on)d(the)g(stack)h
(rather)f(than)h(returning.)37 b(W)l(ith)26 b(this)g(form)g(of)f
(attack,)i(you)g(can)f(get)f(the)h(pro-)0 5237 y(gram)e(to)g(do)g
(almost)h(an)o(ything.)32 b(The)24 b(code)h(you)f(place)i(on)e(the)g
(stack)h(is)f(called)h(the)g Fk(e)n(xploit)h Fl(code.)31
b(This)24 b(style)h(of)f(attack)0 5350 y(is)f(trick)o(y)-6
b(,)24 b(though,)h(because)g(you)e(must)h(get)f(machine)h(code)g(onto)g
(the)g(stack)g(and)g(set)f(the)g(return)i(pointer)g(to)e(the)g(start)h
(of)0 5463 y(this)g(code.)1924 5712 y(6)p eop end
%%Page: 7 7
TeXDict begin 7 6 bop 0 573 a Fl(W)l(ithin)25 b(the)e(\002le)g
Fj(bufbomb)d Fl(there)k(is)g(a)f(function)j Fj(bang)20
b Fl(ha)n(ving)26 b(the)e(follo)n(wing)h(C)d(code:)0
811 y Fh(int)49 b(global_value)f(=)h(0;)0 1010 y(void)g(bang\(int)f
(val\))0 1110 y({)199 1210 y(if)i(\(global_value)d(==)j(cookie\))e({)
399 1309 y(printf\("Bang!:)f(You)i(set)g(global_value)f(to)h
(0x\045x\\n",)g(global_value\);)399 1409 y(validate\(2\);)199
1509 y(})h(else)399 1608 y(printf\("Misfire:)c(global_value)i(=)i
(0x\045x\\n",)e(global_value\);)199 1708 y(exit\(0\);)0
1808 y(})0 2059 y Fl(Similar)24 b(to)h(Le)n(v)o(els)f(0)h(and)g(1,)f
(your)h(task)g(is)g(to)f(get)j Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g
Fl(to)e(e)o(x)o(ecute)g(the)g(code)h(for)e Fj(bang)e
Fl(rather)k(than)f(returning)0 2172 y(to)20 b Fj(test)p
Fl(.)25 b(Before)c(this,)g(ho)n(we)n(v)o(er)l(,)g(you)f(must)g(set)h
(global)g(v)n(ariable)h Fj(global_value)14 b Fl(to)20
b(your)h(userid')-5 b(s)22 b(cookie.)29 b(Y)-10 b(our)0
2285 y(e)o(xploit)27 b(code)f(should)i(set)d Fj(global_value)p
Fl(,)20 b(push)27 b(the)e(address)j(of)d Fj(bang)e Fl(on)j(the)g
(stack,)h(and)f(then)g(e)o(x)o(ecute)h(a)e Fj(ret)0 2398
y Fl(instruction)i(to)c(cause)i(a)e(jump)g(to)h(the)g(code)g(for)g
Fj(bang)p Fl(.)0 2550 y Fi(Some)f(Advice)p Fl(:)136 2777
y Fc(\017)46 b Fl(Y)-10 b(ou)36 b(can)h(use)i Fe(G)t(D)t(B)e
Fl(to)g(get)f(the)h(information)i(you)d(need)i(to)e(construct)j(your)e
(e)o(xploit)h(string.)68 b(Set)36 b(a)g(break-)227 2890
y(point)k(within)g Fj(getbuf)35 b Fl(and)k(run)h(to)f(this)g
(breakpoint.)78 b(Determine)40 b(parameters)h(such)e(as)g(the)g
(address)i(of)227 3003 y Fj(global_value)18 b Fl(and)24
b(the)f(location)j(of)d(the)h(b)n(uf)n(fer)-5 b(.)136
3190 y Fc(\017)46 b Fl(Determining)28 b(the)f(byte)g(encoding)h(of)e
(instruction)k(sequences)f(by)d(hand)h(is)f(tedious)i(and)f(prone)g(to)
f(errors.)38 b(Y)-10 b(ou)227 3303 y(can)26 b(let)g(tools)h(do)f(all)g
(of)g(the)g(w)o(ork)g(by)g(writing)h(an)e(assembly)j(code)e(\002le)g
(containing)j(the)d(instructions)j(and)d(data)227 3416
y(you)c(w)o(ant)g(to)f(put)h(on)g(the)g(stack.)29 b(Assemble)22
b(this)g(\002le)f(with)i Fe(G)t(C)t(C)i Fl(-)t Fe(M)t
Fl(3)t(2)j(-)t Fe(C)23 b Fl(and)f(disassemble)i(it)d(with)j
Fe(O)t(B)t(J)t(D)t(U)t(M)t(P)229 3529 y Fl(-)t Fe(D)r
Fl(.)56 b(Y)-10 b(ou)33 b(should)h(be)f(able)g(to)f(get)h(the)g(e)o
(xact)h(byte)f(sequence)i(that)e(you)g(will)g(type)g(at)g(the)f
(prompt.)57 b(\(A)32 b(brief)227 3642 y(e)o(xample)25
b(of)e(ho)n(w)g(to)h(do)f(this)h(is)g(included)h(at)f(the)g(end)g(of)f
(this)h(writeup.\))136 3829 y Fc(\017)46 b Fl(K)n(eep)20
b(in)h(mind)f(that)h(your)g(e)o(xploit)h(string)g(depends)g(on)f(your)g
(machine,)h(your)f(compiler)l(,)h(and)f(e)n(v)o(en)g(your)g(userid')-5
b(s)227 3942 y(cookie.)39 b(Do)26 b(all)g(of)g(your)i(w)o(ork)e(on)g(a)
g(Fish)h(machine,)h(and)e(mak)o(e)h(sure)g(you)g(include)h(the)f
(proper)g(userid)h(on)f(the)227 4055 y(command)e(line)f(to)h
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)r Fl(.)136 4243 y Fc(\017)46
b Fl(W)-7 b(atch)36 b(your)f(use)h(of)f(address)i(modes)e(when)g
(writing)h(assembly)h(code.)64 b(Note)35 b(that)h Fj(movl)52
b($0x4,)h(\045eax)227 4356 y Fl(mo)o(v)o(es)30 b(the)g
Fk(value)g Fj(0x00000004)25 b Fl(into)30 b(re)o(gister)h
Fj(\045eax)p Fl(;)g(whereas)f Fj(movl)53 b(0x4,)g(\045eax)27
b Fl(mo)o(v)o(es)i(the)h(v)n(alue)227 4469 y Fk(at)25
b Fl(memory)g(location)i Fj(0x00000004)20 b Fl(into)25
b Fj(\045eax)p Fl(.)31 b(Since)25 b(that)g(memory)g(location)i(is)e
(usually)i(unde\002ned,)g(the)227 4582 y(second)e(instruction)i(will)c
(cause)i(a)e(se)o(gf)o(ault!)136 4769 y Fc(\017)46 b
Fl(Do)34 b(not)h(attempt)g(to)f(use)h(either)h(a)e Fj(jmp)e
Fl(or)i(a)g Fj(call)e Fl(instruction)37 b(to)e(jump)f(to)g(the)h(code)g
(for)g Fj(bang)p Fl(.)59 b(These)227 4882 y(instructions)36
b(uses)d(PC-relati)n(v)o(e)f(addressing,)37 b(which)c(is)f(v)o(ery)g
(trick)o(y)h(to)f(set)g(up)h(correctly)-6 b(.)56 b(Instead,)36
b(push)d(an)227 4995 y(address)26 b(on)d(the)h(stack)h(and)f(use)g(the)
f Fj(ret)f Fl(instruction.)1924 5712 y(7)p eop end
%%Page: 8 8
TeXDict begin 8 7 bop 0 573 a Fm(Le)n(v)o(el)30 b(3:)36
b(Dynamite)30 b(\(20)g(pts\))0 819 y Fl(Our)k(preceding)j(attacks)f(ha)
n(v)o(e)f(all)f(caused)i(the)e(program)i(to)e(jump)h(to)f(the)g(code)h
(for)g(some)f(other)i(function,)j(which)0 932 y(then)28
b(causes)g(the)f(program)h(to)f(e)o(xit.)38 b(As)26 b(a)h(result,)h(it)
f(w)o(as)f(acceptable)k(to)c(use)i(e)o(xploit)g(strings)g(that)g
(corrupt)g(the)f(stack,)0 1045 y(o)o(v)o(erwriting)e(sa)n(v)o(ed)g(v)n
(alues.)0 1197 y(The)d(most)g(sophisticated)k(form)c(of)g(b)n(uf)n(fer)
i(o)o(v)o(er\003o)n(w)d(attack)j(causes)f(the)g(program)g(to)f(e)o(x)o
(ecute)i(some)e(e)o(xploit)h(code)g(that)0 1310 y(changes)k(the)e
(program')-5 b(s)26 b(re)o(gister/memory)i(state,)d(b)n(ut)h(mak)o(es)f
(the)g(program)h(return)g(to)f(the)g(original)h(calling)h(function)0
1423 y(\()p Fj(test)f Fl(in)j(this)g(case\).)45 b(The)28
b(calling)j(function)f(is)f(obli)n(vious)i(to)d(the)h(attack.)46
b(This)28 b(style)i(of)e(attack)i(is)f(trick)o(y)-6 b(,)30
b(though,)0 1536 y(since)25 b(you)f(must:)30 b(1\))23
b(get)h(machine)h(code)g(onto)g(the)f(stack,)g(2\))g(set)g(the)g
(return)h(pointer)g(to)f(the)g(start)g(of)g(this)g(code,)h(and)f(3\))0
1649 y(undo)h(an)o(y)e(corruptions)k(made)d(to)f(the)h(stack)g(state.)0
1801 y(Y)-10 b(our)27 b(job)h(for)f(this)h(le)n(v)o(el)f(is)g(to)g
(supply)i(an)e(e)o(xploit)h(string)h(that)e(will)g(cause)h
Fj(getbuf)c Fl(to)j(return)h(your)g(cookie)h(back)f(to)0
1913 y Fj(test)p Fl(,)i(rather)i(than)f(the)g(v)n(alue)h(1.)50
b(Y)-10 b(ou)31 b(can)g(see)g(in)g(the)g(code)h(for)f
Fj(test)d Fl(that)j(this)h(will)e(cause)i(the)f(program)h(to)f(go)0
2026 y(\223)p Fj(Boom!)p Fl(.)-6 b(\224)41 b(Y)-10 b(our)29
b(e)o(xploit)h(code)g(should)g(set)f(your)g(cookie)h(as)f(the)g(return)
h(v)n(alue,)g(restore)h(an)o(y)d(corrupted)k(state,)e(push)0
2139 y(the)24 b(correct)h(return)g(location)g(on)f(the)g(stack,)g(and)g
(e)o(x)o(ecute)h(a)e Fj(ret)e Fl(instruction)27 b(to)c(really)i(return)
g(to)e Fj(test)p Fl(.)0 2291 y Fi(Some)g(Advice)p Fl(:)136
2518 y Fc(\017)46 b Fl(Y)-10 b(ou)28 b(can)h(use)h Fe(G)t(D)t(B)f
Fl(to)f(get)h(the)f(information)j(you)d(need)h(to)f(construct)j(your)e
(e)o(xploit)g(string.)44 b(Set)27 b(a)h(breakpoint)227
2631 y(within)c Fj(getbuf)c Fl(and)k(run)g(to)g(this)g(breakpoint.)32
b(Determine)24 b(parameters)i(such)e(as)f(the)h(sa)n(v)o(ed)h(return)g
(address.)136 2819 y Fc(\017)46 b Fl(Determining)28 b(the)f(byte)g
(encoding)h(of)e(instruction)k(sequences)f(by)d(hand)h(is)f(tedious)i
(and)f(prone)g(to)f(errors.)38 b(Y)-10 b(ou)227 2932
y(can)26 b(let)g(tools)h(do)f(all)g(of)g(the)g(w)o(ork)g(by)g(writing)h
(an)e(assembly)j(code)e(\002le)g(containing)j(the)d(instructions)j(and)
d(data)227 3044 y(you)j(w)o(ant)g(to)f(put)h(on)g(the)g(stack.)44
b(Assemble)30 b(this)f(\002le)f(with)i Fe(G)t(C)t(C)g
Fl(and)f(disassemble)i(it)d(with)i Fe(O)t(B)t(J)t(D)t(U)t(M)t(P)r
Fl(.)45 b(Y)-10 b(ou)227 3157 y(should)30 b(be)e(able)h(to)e(get)i(the)
f(e)o(xact)h(byte)f(sequence)j(that)d(you)h(will)f(type)g(at)g(the)g
(prompt.)43 b(\(A)27 b(brief)i(e)o(xample)g(of)227 3270
y(ho)n(w)23 b(to)h(do)f(this)h(is)g(included)i(at)d(the)h(end)g(of)f
(this)h(writeup.\))136 3458 y Fc(\017)46 b Fl(K)n(eep)20
b(in)h(mind)f(that)h(your)g(e)o(xploit)h(string)g(depends)g(on)f(your)g
(machine,)h(your)f(compiler)l(,)h(and)f(e)n(v)o(en)g(your)g(userid')-5
b(s)227 3571 y(cookie.)39 b(Do)26 b(all)g(of)g(your)i(w)o(ork)e(on)g(a)
g(Fish)h(machine,)h(and)e(mak)o(e)h(sure)g(you)g(include)h(the)f
(proper)g(userid)h(on)f(the)227 3684 y(command)e(line)f(to)h
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)r Fl(.)0 3911 y(Once)k(you)g(complete)h
(this)g(le)n(v)o(el,)g(pause)g(to)e(re\003ect)h(on)g(what)g(you)g(ha)n
(v)o(e)h(accomplished.)47 b(Y)-10 b(ou)28 b(caused)j(a)d(program)i(to)0
4023 y(e)o(x)o(ecute)24 b(machine)g(code)g(of)f(your)g(o)n(wn)g
(design.)30 b(Y)-10 b(ou)22 b(ha)n(v)o(e)i(done)g(so)f(in)g(a)f(suf)n
(\002ciently)j(stealthy)f(w)o(ay)f(that)h(the)f(program)0
4136 y(did)h(not)g(realize)h(that)f(an)o(ything)h(w)o(as)f(amiss.)0
4468 y Fm(Le)n(v)o(el)30 b(4:)36 b(Nitr)n(oglycerin)31
b(\(10)e(pts\))0 4714 y Fl(Please)24 b(note:)30 b(Y)-10
b(ou')o(ll)24 b(need)h(to)e(use)h(the)g(\223)p Fj(-n)p
Fl(,)-6 b(\224)22 b(command-line)k(\003ag)d(in)g(order)i(to)e(run)h
(this)g(stage.)0 4866 y(From)h(one)i(run)f(to)g(another)l(,)j
(especially)g(by)d(dif)n(ferent)i(users,)f(the)g(e)o(xact)f(stack)h
(positions)i(used)e(by)f(a)g(gi)n(v)o(en)g(procedure)0
4979 y(will)j(v)n(ary)-6 b(.)46 b(One)29 b(reason)h(for)g(this)f(v)n
(ariation)j(is)d(that)g(the)h(v)n(alues)g(of)f(all)g(en)l(vironment)k
(v)n(ariables)e(are)e(placed)i(near)f(the)0 5092 y(base)g(of)f(the)g
(stack)i(when)e(a)g(program)h(starts)g(e)o(x)o(ecuting.)48
b(En)l(vironment)31 b(v)n(ariables)h(are)d(stored)h(as)g(strings,)h
(requiring)0 5205 y(dif)n(ferent)j(amounts)f(of)e(storage)j(depending)g
(on)e(their)h(v)n(alues.)54 b(Thus,)34 b(the)e(stack)h(space)g
(allocated)h(for)e(a)f(gi)n(v)o(en)h(user)0 5318 y(depends)j(on)e(the)h
(settings)h(of)e(his)g(or)g(her)h(en)l(vironment)i(v)n(ariables.)59
b(Stack)34 b(positions)h(also)f(dif)n(fer)g(when)f(running)i(a)0
5431 y(program)25 b(under)h Fe(G)t(D)t(B)r Fl(,)d(since)j
Fe(G)t(D)t(B)f Fl(uses)f(stack)h(space)g(for)e(some)h(of)f(its)h(o)n
(wn)f(state.)1924 5712 y(8)p eop end
%%Page: 9 9
TeXDict begin 9 8 bop 0 573 a Fl(In)23 b(the)h(code)g(that)f(calls)i
Fj(getbuf)p Fl(,)19 b(we)j(ha)n(v)o(e)i(incorporated)j(features)e(that)
f(stabilize)i(the)d(stack,)h(so)f(that)h(the)g(position)h(of)0
686 y Fj(getbuf)p Fl(')-5 b(s)26 b(stack)k(frame)e(will)h(be)f
(consistent)k(between)e(runs.)45 b(This)28 b(made)h(it)f(possible)j
(for)e(you)h(to)e(write)h(an)g(e)o(xploit)0 799 y(string)e(kno)n(wing)g
(the)f(e)o(xact)g(starting)i(address)f(of)f Fj(buf)p
Fl(.)33 b(If)26 b(you)g(tried)g(to)g(use)g(such)h(an)e(e)o(xploit)i(on)
f(a)g(normal)g(program,)0 912 y(you)h(w)o(ould)g(\002nd)f(that)h(it)f
(w)o(orks)g(some)h(times,)g(b)n(ut)g(it)f(causes)h(se)o(gmentation)i(f)
o(aults)f(at)e(other)h(times.)38 b(Hence)26 b(the)h(name)0
1024 y(\223dynamite\224\227an)38 b(e)o(xplosi)n(v)o(e)e(de)n(v)o
(eloped)h(by)d(Alfred)h(Nobel)g(that)g(contains)i(stabilizing)h
(elements)e(to)e(mak)o(e)h(it)f(less)0 1137 y(prone)25
b(to)e(une)o(xpected)k(e)o(xplosions.)0 1289 y(F)o(or)i(this)i(le)n(v)o
(el,)g(we)e(ha)n(v)o(e)i(gone)g(the)f(opposite)i(direction,)i(making)c
(the)h(stack)g(positions)h(e)n(v)o(en)e(less)h(stable)g(than)g(the)o(y)
0 1402 y(normally)25 b(are.)k(Hence)24 b(the)g(name)f
(\223nitroglycerin\224\227an)29 b(e)o(xplosi)n(v)o(e)c(that)f(is)g
(notoriously)j(unstable.)0 1554 y(When)c(you)g(run)h
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)h Fl(with)e(the)f(command)h(line)g(\003ag)
f(\223)p Fj(-n)p Fl(,)-6 b(\224)21 b(it)h(will)g(run)h(in)f
(\223Nitro\224)i(mode.)k(Rather)23 b(than)g(calling)0
1667 y(the)h(function)i Fj(getbuf)p Fl(,)19 b(the)24
b(program)h(calls)f(a)f(slightly)j(dif)n(ferent)f(function)h
Fj(getbufn)p Fl(:)0 1906 y Fh(int)49 b(getbufn\(\))0
2005 y({)199 2105 y(char)g(buf[512];)199 2205 y(Gets\(buf\);)199
2304 y(return)g(1;)0 2404 y(})0 2656 y Fl(This)27 b(function)i(is)e
(similar)h(to)f Fj(getbuf)p Fl(,)d(e)o(xcept)k(that)g(it)e(has)i(a)e(b)
n(uf)n(fer)j(of)e(512)g(characters.)42 b(Y)-10 b(ou)27
b(will)f(need)i(this)g(addi-)0 2768 y(tional)i(space)f(to)g(create)h(a)
e(reliable)i(e)o(xploit.)45 b(The)28 b(code)h(that)g(calls)h
Fj(getbufn)24 b Fl(\002rst)k(allocates)j(a)d(random)i(amount)f(of)0
2881 y(storage)i(on)f(the)g(stack)h(\(using)g(library)h(function)g
Fj(alloca)p Fl(\))26 b(that)k(ranges)i(between)e(0)g(and)g(255)g
(bytes.)49 b(Thus,)31 b(if)e(you)0 2994 y(were)j(to)h(sample)g(the)g(v)
n(alue)g(of)g Fj(\045ebp)d Fl(during)k(tw)o(o)e(successi)n(v)o(e)j(e)o
(x)o(ecutions)g(of)d Fj(getbufn)p Fl(,)f(you)i(w)o(ould)g(\002nd)g(the)
o(y)0 3107 y(dif)n(fer)24 b(by)g(as)f(much)h(as)g Fc(\006)p
Fa(127)p Fl(.)0 3259 y(In)34 b(addition,)k(when)c(run)g(in)g(Nitro)f
(mode,)39 b Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)d Fl(requires)g(you)e(to)g
(supply)h(your)g(string)g(5)e(times,)k(and)d(it)f(will)0
3372 y(e)o(x)o(ecute)27 b Fj(getbufn)22 b Fl(5)j(times,)i(each)f(with)g
(a)f(dif)n(ferent)j(stack)f(of)n(fset.)36 b(Y)-10 b(our)26
b(e)o(xploit)h(string)h(must)d(mak)o(e)h(it)g(return)h(your)0
3485 y(cookie)e(each)f(of)g(these)g(times.)0 3637 y(Y)-10
b(our)26 b(task)g(is)g(identical)i(to)d(the)h(task)h(for)e(the)h
(Dynamite)h(le)n(v)o(el.)35 b(Once)26 b(again,)h(your)f(job)g(for)g
(this)g(le)n(v)o(el)g(is)g(to)g(supply)h(an)0 3750 y(e)o(xploit)f
(string)h(that)f(will)e(cause)i Fj(getbufn)c Fl(to)j(return)h(your)g
(cookie)h(back)e(to)h(test,)f(rather)h(than)g(the)g(v)n(alue)g(1.)33
b(Y)-10 b(ou)25 b(can)0 3863 y(see)31 b(in)f(the)g(code)h(for)g(test)f
(that)h(this)g(will)f(cause)h(the)g(program)g(to)f(go)h(\223)p
Fj(KABOOM!)p Fl(.)-6 b(\224)45 b(Y)-10 b(our)30 b(e)o(xploit)i(code)f
(should)h(set)0 3976 y(your)e(cookie)h(as)f(the)g(return)h(v)n(alue,)g
(restore)g(an)o(y)f(corrupted)i(state,)g(push)e(the)g(correct)h(return)
g(location)h(on)d(the)h(stack,)0 4089 y(and)24 b(e)o(x)o(ecute)h(a)e
Fj(ret)e Fl(instruction)27 b(to)c(really)i(return)g(to)e
Fj(testn)p Fl(.)0 4241 y Fi(Some)g(Advice)p Fl(:)136
4468 y Fc(\017)46 b Fl(Y)-10 b(ou)33 b(can)f(use)h(the)g(program)j
Fe(H)t(E)t(X)t Fl(2)t Fe(R)t(A)m(W)g Fl(to)c(send)i(multiple)f(copies)h
(of)f(your)g(e)o(xploit)h(string.)57 b(If)32 b(you)h(ha)n(v)o(e)g(a)227
4580 y(single)25 b(cop)o(y)g(in)e(the)h(\002le)f Fj(exploit.txt)p
Fl(,)17 b(then)25 b(you)f(can)g(use)g(the)f(follo)n(wing)i(command:)227
4817 y Fh(unix>)49 b Fg(cat)g(exploit.txt)f(|)i(./hex2raw)e(-n)h(|)h
(./bufbomb)e(-n)i(-t)f(bovik@ANDREW.CMU.EDU)227 5067
y Fl(Y)-10 b(ou)23 b(must)f(use)h(the)g(same)f(string)i(for)f(all)f(5)h
(e)o(x)o(ecutions)h(of)f Fj(getbufn)p Fl(.)h(Otherwise)g(it)e(will)g(f)
o(ail)h(the)g(testing)h(code)227 5180 y(used)h(by)e(our)h(grading)i
(serv)o(er)-5 b(.)136 5368 y Fc(\017)46 b Fl(The)23 b(trick)i(is)e(to)h
(mak)o(e)f(use)h(of)g(the)f Fj(nop)f Fl(instruction.)32
b(It)23 b(is)g(encoded)j(with)d(a)g(single)i(byte)g(\(code)f
Fj(0x90)p Fl(\).)1924 5712 y(9)p eop end
%%Page: 10 10
TeXDict begin 10 9 bop 0 573 a Fm(Logistical)29 b(Notes)0
819 y Fl(Hand)f(in)g(occurs)i(automatically)h(to)d(the)h(Autolab)g
(serv)o(er)g(whene)n(v)o(er)g(you)g(correctly)h(solv)o(e)f(a)f(le)n(v)o
(el.)42 b(Upon)29 b(recei)n(ving)0 932 y(your)f(solution,)i(the)e(serv)
o(er)g(will)f(v)n(alidate)i(your)f(string)g(and)g(update)h(the)f(class)
g(status)g(web)f(page.)41 b(Y)-10 b(ou)27 b(should)i(check)0
1045 y(this)c(page)g(after)g(your)h(submission)h(to)d(mak)o(e)h(sure)g
(your)g(string)h(has)f(been)g(v)n(alidated.)33 b([If)25
b(you)g(really)h(solv)o(ed)f(the)g(le)n(v)o(el,)0 1158
y(your)f(string)h Fk(should)g Fl(be)f(v)n(alid.])0 1310
y(Note)h(that)h(each)h(le)n(v)o(el)e(is)g(graded)i(indi)n(vidually)-6
b(.)38 b(Y)-10 b(ou)26 b(do)f(not)h(need)g(to)f(do)h(them)f(in)h(the)f
(speci\002ed)i(order)l(,)g(b)n(ut)f(you)g(will)0 1423
y(get)h(credit)h(only)f(for)g(the)g(le)n(v)o(els)h(for)f(which)g(the)g
(serv)o(er)g(recei)n(v)o(es)h(a)f(v)n(alid)g(message.)40
b(Y)-10 b(ou)26 b(can)h(check)h(the)f(class)h(status)0
1536 y(page)c(to)g(see)g(ho)n(w)f(f)o(ar)g(you')-5 b(v)o(e)26
b(gotten.)0 1688 y(The)20 b Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)g
Fl(utility)g(usually)g(only)f(calls)g Fj(validate)13
b Fl(once)19 b(you)g(ha)n(v)o(e)f(successfully)k(completed)e(a)e
(phase.)28 b Fj(validate)0 1801 y Fl(forw)o(ards)21 b(your)f(e)o
(xploit)h(string)g(to)e(the)h(Autolab)g(serv)o(er)l(,)i(where)e(it)f
(is)g(check)o(ed.)30 b(If)19 b(you)h(call)g Fj(validate)15
b Fl(by)k(some)h(other)0 1913 y(means,)k(it)f(will)h(send)g(a)f(non-w)o
(orking)k(e)o(xploit)e(string.)30 b(The)23 b(Autolab)i(serv)o(er)g
(will)e(generate)j(an)d(In)l(v)n(alid)j(Answer)d(error)-5
b(.)0 2026 y(In)l(v)n(alid)25 b(solutions)h(are)d(mark)o(ed)h(on)f(the)
h(status)g(page)g(with)f(an)g(in)l(v)n(alid)i(icon.)k(Click)23
b(on)h(this)f(icon)h(to)f(see)h(the)f(diagnostic)0 2139
y(report)i(generated)h(by)e(running)h(your)f(solution.)0
2291 y(Furthermore,)41 b(Autolab)d(creates)g(the)f(status)g(page)h
(using)g(the)e(latest)i(results)g(it)e(has)h(for)g(each)g(phase.)69
b(If)36 b(you)h(call)0 2404 y Fj(validate)27 b Fl(and)32
b(end)g(up)f(sending)j(an)d(incorrect)j(e)o(xploit)e(string)h(to)e
(Autolab,)k(it)c(will)g(mark)g(your)h(solution)i(to)d(that)0
2517 y(phase)g(as)g(in)l(v)n(alid,)i(e)n(v)o(en)e(if)f(you)g(solv)o(ed)
i(it)e(correctly)i(at)e(an)h(earlier)g(time.)49 b(T)-7
b(o)29 b(\002x)h(this,)i(send)f(your)g(correct)h(solution)0
2630 y(again.)0 2782 y(Good)24 b(luck)g(and)g(ha)n(v)o(e)g(fun!)0
3114 y Fm(\224Hacking\224)30 b(Bu\003ab)0 3360 y Fl(F)o(or)24
b(man)o(y)h(of)g(these)i(le)n(v)o(els)f(it)e(is)h(possible)j(to)d(mak)o
(e)g(your)h(e)o(xploit)h(return)f(past)g(conditional)j(checks)e(in)e
(our)g(code.)35 b(F)o(or)0 3473 y(e)o(xample,)f(in)d(Le)n(v)o(el)g(2:)
44 b(Firecrack)o(er)l(,)35 b(it)c(is)h(possible)h(to)e(ha)n(v)o(e)h
(your)g(e)o(xploit)h(return)f(directly)h(directly)h(to)d(the)g(call)h
(to)0 3586 y(v)n(alidate)g(and)e(skip)h(the)f(check)h(of)f
Fj(global_value)49 b(==)k(cookie)p Fl(.)45 b(This)29
b(is)h(not)g(a)g(v)n(alid)h(solution)h(to)d(this)i(le)n(v)o(el,)0
3699 y(through)25 b(this)f(entire)g(lab,)f Fi(r)n(etur)o(ning)h
(anywher)n(e)f(except)h(f)n(or)f(the)f(v)o(ery)i(beginning)f(of)g(any)g
(function)f(is)h(consider)n(ed)0 3812 y(an)f(in)l(v)o(alid)h
(submission)f(and)f(will)i(r)n(ecei)o(v)o(e)i(zer)n(o)e(points)p
Fl(.)28 b(This)23 b(is)f(v)o(ery)h(important)i(because)f(Autolab)g
(does)f(not)g(ha)n(v)o(e)0 3925 y(the)28 b(ability)h(to)f(check)h(for)f
(this,)h(ho)n(we)n(v)o(er)f(we)f(will)g(read)h(your)h(submissions)h
(after)f(the)f(deadline)i(and)e(subtract)h(points)0 4037
y(for)24 b(an)o(y)f(in)l(v)n(alid)j(submissions)g(at)d(that)h(time.)0
4369 y Fm(Generating)31 b(Byte)e(Codes)0 4602 y Fl(Using)c
Fe(G)t(C)t(C)f Fl(as)e(an)h(assembler)i(and)g Fe(O)t(B)t(J)t(D)t(U)t(M)
t(P)g Fl(as)e(a)f(disassembler)k(mak)o(es)d(it)f(con)l(v)o(enient)k(to)
d(generate)h(the)f(byte)h(codes)0 4702 y(for)35 b(instruction)j
(sequences.)66 b(F)o(or)34 b(e)o(xample,)k(suppose)f(we)d(write)h(a)f
(\002le)g Fj(example.S)c Fl(containing)38 b(the)d(follo)n(wing)0
4801 y(assembly)25 b(code:)0 5015 y Fh(#)50 b(Example)e(of)i
(hand-generated)d(assembly)h(code)0 5214 y(push)h($0xabcdef)447
b(#)49 b(Push)g(value)g(onto)g(stack)0 5314 y(add)149
b($17,\045eax)497 b(#)49 b(Add)g(17)h(to)f(\045eax)0
5413 y(.align)g(4)797 b(#)49 b(Following)f(will)h(be)h(aligned)e(on)i
(multiple)e(of)h(4)1901 5712 y Fl(10)p eop end
%%Page: 11 11
TeXDict begin 11 10 bop 0 573 a Fh(.long)149 b(0xfedcba98)297
b(#)49 b(A)h(4-byte)e(constant)0 899 y Fl(The)35 b(code)i(can)g
(contain)g(a)f(mixture)h(of)f(instructions)j(and)d(data.)67
b(An)o(ything)37 b(to)f(the)g(right)h(of)f(a)f(`)p Fj(#)p
Fl(')g(character)k(is)c(a)0 1012 y(comment.)0 1151 y(W)-7
b(e)23 b(can)h(no)n(w)f(assemble)i(and)f(disassemble)i(this)e(\002le:)0
1364 y Fh(unix>)49 b Fg(gcc)g(-m32)g(-c)h(example.S)0
1464 y Fh(unix>)f Fg(objdump)f(-d)i(example.o)e(>)i(example.d)0
1678 y Fl(The)23 b(generated)j(\002le)d Fj(example.d)c
Fl(contains)25 b(the)f(follo)n(wing)h(lines)149 1891
y Fh(0:)50 b(68)f(ef)h(cd)f(ab)h(00)398 b(push)148 b($0xabcdef)149
1991 y(5:)50 b(83)f(c0)h(11)697 b(add)198 b($0x11,\045eax)149
2090 y(8:)50 b(98)996 b(cwtl)149 2190 y(9:)50 b(ba)996
b(.byte)49 b(0xba)149 2290 y(a:)h(dc)f(fe)847 b(fdivr)98
b(\045st,\045st\(6\))0 2516 y Fl(Each)24 b(line)g(sho)n(ws)g(a)f
(single)i(instruction.)33 b(The)23 b(number)i(on)f(the)g(left)g
(indicates)i(the)e(starting)i(address)g(\(starting)g(with)d(0\),)0
2629 y(while)h(the)g(he)o(x)g(digits)h(after)f(the)h(`)p
Fj(:)p Fl(')e(character)j(indicate)f(the)g(byte)f(codes)h(for)f(the)g
(instruction.)33 b(Thus,)23 b(we)g(can)h(see)g(that)0
2742 y(the)g(instruction)i Fj(push)53 b($0xABCDEF)19
b Fl(has)24 b(he)o(x-formatted)i(byte)e(code)h Fj(68)53
b(ef)h(cd)g(ab)f(00)p Fl(.)0 2894 y(Starting)22 b(at)e(address)i(8,)f
(the)g(disassembler)i(gets)e(confused.)30 b(It)20 b(tries)i(to)e
(interpret)j(the)e(bytes)g(in)g(the)f(\002le)g Fj(example.o)c
Fl(as)0 3007 y(instructions,)26 b(b)n(ut)d(these)h(bytes)f(actually)i
(correspond)g(to)e(data.)29 b(Note,)22 b(ho)n(we)n(v)o(er)l(,)h(that)h
(if)e(we)g(read)h(of)n(f)f(the)h(4)f(bytes)i(start-)0
3120 y(ing)i(at)g(address)h(8)f(we)f(get:)33 b Fj(98)54
b(ba)g(dc)f(fe)p Fl(.)34 b(This)26 b(is)f(a)g(byte-re)n(v)o(ersed)k(v)o
(ersion)f(of)d(the)h(data)h(w)o(ord)f Fj(0xFEDCBA98)p
Fl(.)0 3233 y(This)j(byte)i(re)n(v)o(ersal)f(represents)j(the)c(proper)
i(w)o(ay)e(to)h(supply)h(the)f(bytes)g(as)g(a)f(string,)j(since)e(a)f
(little)i(endian)g(machine)0 3346 y(lists)24 b(the)g(least)g
(signi\002cant)i(byte)e(\002rst.)0 3485 y(Finally)-6
b(,)24 b(we)f(can)h(read)g(of)n(f)f(the)h(byte)h(sequence)g(for)f(our)g
(code)g(as:)0 3698 y Fh(68)49 b(ef)h(cd)f(ab)h(00)f(83)h(c0)f(11)h(98)f
(ba)g(dc)h(fe)0 4011 y Fl(This)19 b(string)h(can)f(then)h(be)f(passed)h
(through)j Fe(H)t(E)t(X)t Fl(2)t Fe(R)t(A)m(W)g Fl(to)c(generate)i(a)e
(proper)h(input)g(string)g(we)e(can)i(gi)n(v)o(e)f(to)i
Fe(B)s(U)t(F)t(B)t(O)t(M)t(B)r Fl(.)0 4111 y(Alternati)n(v)o(ely)-6
b(,)26 b(we)c(can)i(edit)g(e)o(xample.d)h(to)e(look)i(lik)o(e)f(this:)0
4324 y Fh(68)49 b(ef)h(cd)f(ab)h(00)f(/)797 4339 y(*)897
4324 y(push)148 b($0xabcdef)1743 4339 y(*)1793 4324 y(/)0
4424 y(83)49 b(c0)h(11)f(/)498 4439 y(*)598 4424 y(add)198
b($0x11,\045eax)1494 4439 y(*)1544 4424 y(/)0 4524 y(98)0
4623 y(ba)49 b(dc)h(fe)0 4850 y Fl(which)24 b(is)f(also)h(a)g(v)n(alid)
g(input)g(we)f(can)h(pass)g(through)k Fe(H)t(E)t(X)t
Fl(2)t Fe(R)t(A)m(W)f Fl(before)e(sending)h(to)f Fe(B)s(U)t(F)t(B)t(O)t
(M)t(B)r Fl(.)1901 5712 y(11)p eop end
%%Trailer

userdict /end-hook known{end-hook}if
%%EOF
